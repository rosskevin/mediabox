version: "3.3"

#
# This file enables SSO via Google Cloud OAUTH.  Additionally, it layers in rate limiting.
#
services:
  plex:
    labels:
      - traefik.http.routers.plex.middlewares=chain-oauth@docker
  sabnzbd:
    labels:
      # Note: Traefik 3.x removed Headers/HeadersRegexp from router rules
      # API key bypass is now handled by the forward-auth container (oauth) configuration
      # See traefik-oauth.yml for the command line option to enable bypass rules

      # Main router with OAuth
      - traefik.http.routers.sabnzbd.middlewares=chain-oauth@docker
  sonarr:
    labels:
      - traefik.http.routers.sonarr.middlewares=chain-oauth@docker
  radarr:
    labels:
      - traefik.http.routers.radarr.middlewares=chain-oauth@docker    
  prowlarr:
    labels:
      - traefik.http.routers.prowlarr.middlewares=chain-oauth@docker
  organizr:
    labels:
      - traefik.http.routers.organizr.middlewares=chain-oauth@docker